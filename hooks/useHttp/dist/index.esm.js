import e from"axios";class s{httpStatus;success=!1;message="";data;code;error;originData;headers;constructor(e){const{headers:s,status:t,data:a,message:r,originData:n,error:o}=e;this.headers=s,this.httpStatus=t,this.data=a,this.message=r,this.originData=n,this.error=o}}const t={timeout:3e4,successCode:"000000",messageFiled:"info"},a={headers:{},timeout:t.timeout,successCode:t.successCode,messageFiled:t.messageFiled,onRequest:e=>e,onResponse:r,onError:function(e){const t=function(e){let s="";if(e&&e.response)switch(e.response.status){case 302:s="接口重定向了";break;case 400:s="参数不正确";break;case 401:s="您未登录，或者登录已经超时，请先登录";break;case 403:s="您没有权限操作";break;case 404:s="请求地址出错了";break;case 408:s="请求超时";break;case 409:s="系统已存在相同数据";break;case 500:s="服务器内部错误";break;case 501:s="服务未实现";break;case 502:s="网关错误了";break;case 503:s="服务不可用";break;case 504:s="服务暂时无法访问，请稍后再试";break;case 505:s="HTTP版本不受支持";break;default:s="异常问题，请联系管理员"}return e.message.includes("timeout")&&(s="网络请求超时"),e.message.includes("Network")&&(s=window.navigator.onLine?"网络异常":"您断网了"),s}(e),a=new s({error:e,message:t});return a.success=!1,a}};function r(e,t){const{data:a,status:r,headers:n}=e,o=new s({headers:n,status:r,originData:a});if(a){const{data:e,code:s}=a,{successCode:r,messageFiled:n}=t;o.code=s,o.data=e,o.message=a[n||"info"],o.success=s===r}return o}class n{instance;instanceConfig;constructor(s){const t=Object.assign({},a,s);this.instance=e.create(t),this.instanceConfig=t,this.instance.interceptors.request.use((e=>{const{onRequest:s}=e;return s?s(e):e})),this.instance.interceptors.response.use((e=>this.instanceConfig.onResponse?this.instanceConfig.onResponse(e,this.instanceConfig):e),(e=>{const{onError:s}=this.instanceConfig;return s?Promise.reject(s(e)):Promise.reject(e)}))}request(e){return this.instance.request(e)}get(e,s,t){return this.request({...s,method:"get",url:e,extraParams:t})}post(e,s,t){return this.request({...s,method:"post",url:e,extraParams:t})}put(e,s,t){return this.request({...s,method:"put",url:e,extraParams:t})}del(e,s,t){return this.request({...s,method:"delete",url:e,extraParams:t})}}var o=Object.freeze({__proto__:null,default:n,defalutOnResponse:r});export{n as HttpService,o as useHttp};
